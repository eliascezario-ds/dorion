var e;import{setResolveAlias as t}from"../../scripts/figma-variables/state.mjs";import{renderCSS as r}from"../../scripts/figma-variables/render-css.mjs";import{navigateTo as n,goBack as a,enableResize as o}from"../../scripts/features/navigation.mjs";import{renderTree as c,rebuildTree as i}from"../../scripts/figma-variables/render-tree.mjs";import{buildHierarchy as s}from"../../scripts/figma-variables/build-hierarchy.mjs";import{resolveValue as l}from"../../scripts/figma-variables/resolve-value.mjs";import{buildCSSVariableName as u,normalize as d}from"../../scripts/figma-variables/utils.mjs";import{presetConfig as p,applyPresetByAttribute as m,applyPresetFromUI as f}from"../../scripts/figma-variables/preset.mjs";import"../features/style.css";parent.postMessage({pluginMessage:{type:"ready"}},"*"),window.addEventListener("message",function(e){var t=e.data.pluginMessage;if("variables"===t.type){currentData=t.data,t.filename&&(currentFilename=t.filename),idMap.clear(),currentData.forEach(function(e){return e.variables.forEach(function(t){t.collectionName=e.name,idMap.set(t.id,t)})});var n=currentData.map(function(e){return e.name}),a=orderState.get("")||[];a=a.filter(function(e){return n.includes(e)}),n.forEach(function(e){a.includes(e)||a.push(e)}),0===a.length&&n.length>0&&(a=n.slice()),orderState.set("",a),i(),r()}}),document.querySelector(".fr-canvas-footer #refresh").onclick=function(){return window.parent.postMessage({pluginMessage:{type:"refresh"}},"*")},document.querySelector(".fr-canvas-footer #export").onclick=function(){var e=new Blob([lastCSSOutput],{type:"text/css"}),t=document.createElement("a");t.href=URL.createObjectURL(e),t.download="".concat(currentFilename,".css"),t.click()},document.querySelector(".fr-canvas-footer #copy").onclick=function(){function e(e){var t=document.createElement("textarea");t.value=e,t.style.position="fixed",t.style.opacity="0",document.body.appendChild(t),t.focus(),t.select();try{var r=document.execCommand("copy");window.parent.postMessage({pluginMessage:{type:"notify",message:r?"⮻ Copiado!":"Falha ao copiar"}},"*")}catch(e){window.parent.postMessage({pluginMessage:{type:"notify",message:"Erro ao copiar"}},"*")}document.body.removeChild(t)}document.querySelector(".fr-canvas-footer #copy").onclick=function(){navigator.clipboard&&navigator.clipboard.writeText?navigator.clipboard.writeText(lastCSSOutput).then(function(){return window.parent.postMessage({pluginMessage:{type:"notify",message:"⮻ Copiado!"}},"*")}).catch(function(){return e(lastCSSOutput)}):e(lastCSSOutput)}},window.addEventListener("DOMContentLoaded",function(){n("screen-index")}),document.querySelectorAll(".goToCss").forEach(function(e){e.addEventListener("click",function(){return n("screen-css")})}),document.querySelectorAll(".goToAbout").forEach(function(e){e.addEventListener("click",function(){return n("screen-about")})}),document.querySelectorAll(".goToBack").forEach(function(e){e.addEventListener("click",function(){return a()})}),null===(e=document.getElementById("btn-refColorDim"))||void 0===e||e.addEventListener("click",function(){applyDeclarativePreset("refColorDim")});export function applyTheme(){var e=window.matchMedia("(prefers-color-scheme: dark)").matches;document.body.classList.toggle("dark",e),document.body.classList.toggle("light",!e)}applyTheme(),window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",applyTheme);var g=document.getElementById("context-menu-var-css"),v=document.querySelector(".fr-tree-header");null==v||v.addEventListener("contextmenu",function(e){e.preventDefault(),g.style.display="block",g.style.left="".concat(e.pageX,"px"),g.style.top="".concat(e.pageY,"px")}),document.addEventListener("click",function(){g.style.display="none"}),document.querySelectorAll("[data-preset]").forEach(function(e){e.addEventListener("click",function(){var t=e.getAttribute("data-preset");f(t)})});var y=document.getElementById("toggle-alias");y&&(y.checked=!0,y.addEventListener("change",function(e){t(e.target.checked),r()}));